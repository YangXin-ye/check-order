# 后台接口文档
## 数据准备
### 数据库
```sql
/*
 Navicat Premium Data Transfer

 Source Server         : localhost_mysql8
 Source Server Type    : MySQL
 Source Server Version : 80031 (8.0.31)
 Source Host           : localhost:3307
 Source Schema         : accounting_system

 Target Server Type    : MySQL
 Target Server Version : 80031 (8.0.31)
 File Encoding         : 65001

 Date: 20/10/2024 19:13:33
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for menu
-- ----------------------------
DROP TABLE IF EXISTS `menu`;
CREATE TABLE `menu` (
  `id` int NOT NULL AUTO_INCREMENT COMMENT 'id',
  `name` varchar(255) DEFAULT NULL COMMENT '名称',
  `label` varchar(255) DEFAULT NULL COMMENT '标签',
  `icon` varchar(255) DEFAULT NULL COMMENT '图标',
  `url` varchar(255) DEFAULT NULL COMMENT '页面链接',
  `path` varchar(255) DEFAULT NULL COMMENT '链接',
  `parent` int DEFAULT NULL COMMENT '父级Id，没有父级为0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=32 DEFAULT CHARSET=utf8mb3 COMMENT='前端菜单';

-- ----------------------------
-- Records of menu
-- ----------------------------
BEGIN;
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (1, 'main', '首页', 's-home', 'Home/Home', '/', 0);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (2, 'customer', '用户管理', 'user', NULL, NULL, 0);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (3, 'customerList', '管理员列表', 'setting', 'customer/customerList', '/CustomerList', 2);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (4, 'commonCustomer', '用户列表', 'setting', 'customer/commonCustomer', '/CommonCustomer', 2);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (6, 'calssifyManager', '分类管理', 'setting', NULL, NULL, 0);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (7, 'classifyList', '分类列表', 'setting', '/classify/list', '/classifyList', 6);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (8, 'dataManager', '数据管理', 'setting', '', NULL, 0);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (9, 'dataList', '数据列表', 'setting', '/data/list', '/dataList', 8);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (10, 'dataRestore', '数据恢复', 'setting', '/data/restore', '/dataRestore', 8);
INSERT INTO `menu` (`id`, `name`, `label`, `icon`, `url`, `path`, `parent`) VALUES (25, 'userInfo', '个人信息', 'user', '/upInfo', '/upInfo', 0);
COMMIT;

-- ----------------------------
-- Table structure for t_accountion_record
-- ----------------------------
DROP TABLE IF EXISTS `t_accountion_record`;
CREATE TABLE `t_accountion_record` (
  `id` int NOT NULL AUTO_INCREMENT,
  `user_id` int DEFAULT NULL COMMENT '用户Id',
  `classify_id` int DEFAULT NULL COMMENT '分类Id',
  `type` int DEFAULT NULL COMMENT '1支出 2收入',
  `price` decimal(10,2) DEFAULT NULL COMMENT '金额',
  `remark` varchar(255) DEFAULT NULL COMMENT '备注',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  `delete` tinyint NOT NULL DEFAULT '0' COMMENT '0未删除1删除',
  `year` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '年',
  `month` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '月',
  `day` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '日',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='收支明细';

-- ----------------------------
-- Records of t_accountion_record
-- ----------------------------
BEGIN;
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (2, 1, 1, 1, 1000.00, '充话费', '2024-10-19 09:33:43', '2024-10-19 18:24:18', 0, '2024', '10', '19');
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (3, 1, 2, 2, 90.20, '兼职', '2024-10-19 09:34:20', '2024-10-19 15:53:04', 0, '2024', '10', '19');
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (4, 1, 1, 1, 100.00, '充话费', '2024-10-18 09:33:43', '2024-10-18 09:33:57', 0, '2024', '10', '18');
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (5, 1, 2, 2, 222.00, '1212', '2024-10-19 12:14:39', '2024-10-19 12:14:39', 0, '2024', '10', '19');
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (6, 1, 2, 2, 222.00, '1212', '2024-10-19 12:14:45', '2024-10-19 12:14:45', 0, '2024', '10', '19');
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (7, 1, 2, 2, 222.00, '1212', '2024-10-19 12:14:51', '2024-10-19 12:14:51', 0, '2024', '10', '19');
INSERT INTO `t_accountion_record` (`id`, `user_id`, `classify_id`, `type`, `price`, `remark`, `create_time`, `update_time`, `delete`, `year`, `month`, `day`) VALUES (8, 1, 2, 2, 111.00, '1123213', '2024-10-19 12:15:44', '2024-10-19 12:15:44', 0, '2024', '10', '19');
COMMIT;

-- ----------------------------
-- Table structure for t_bank
-- ----------------------------
DROP TABLE IF EXISTS `t_bank`;
CREATE TABLE `t_bank` (
  `id` int NOT NULL AUTO_INCREMENT,
  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `user_id` int NOT NULL,
  `create_time` datetime NOT NULL,
  `delete` tinyint NOT NULL DEFAULT '0' COMMENT '0未删除1删除',
  `bank_logo` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `bank_type` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `limit_num` varchar(255) DEFAULT NULL,
  `bank_num` varchar(255) DEFAULT NULL,
  `bank_bg` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='银行卡信息';

-- ----------------------------
-- Records of t_bank
-- ----------------------------
BEGIN;
INSERT INTO `t_bank` (`id`, `name`, `user_id`, `create_time`, `delete`, `bank_logo`, `bank_type`, `limit_num`, `bank_num`, `bank_bg`) VALUES (1, '建设银行', 1, '2024-10-20 01:17:42', 0, '/img/jianhang.5f2be68a.svg', '储蓄卡', '20', '1231230234', '#3973c4');
INSERT INTO `t_bank` (`id`, `name`, `user_id`, `create_time`, `delete`, `bank_logo`, `bank_type`, `limit_num`, `bank_num`, `bank_bg`) VALUES (2, '建设银行', 1, '2024-10-20 01:29:07', 0, 'jianhang', '储蓄卡', '20', '123', '#3973c4');
INSERT INTO `t_bank` (`id`, `name`, `user_id`, `create_time`, `delete`, `bank_logo`, `bank_type`, `limit_num`, `bank_num`, `bank_bg`) VALUES (3, '农业银行', 1, '2024-10-20 01:30:23', 0, 'nonghang', '储蓄卡', '40', '123123123123', '#32977f');
INSERT INTO `t_bank` (`id`, `name`, `user_id`, `create_time`, `delete`, `bank_logo`, `bank_type`, `limit_num`, `bank_num`, `bank_bg`) VALUES (4, '工商银行', 1, '2024-10-20 01:36:04', 0, 'nonghang', '储蓄卡', '40', '9999', '#32977f');
INSERT INTO `t_bank` (`id`, `name`, `user_id`, `create_time`, `delete`, `bank_logo`, `bank_type`, `limit_num`, `bank_num`, `bank_bg`) VALUES (5, '建设银行', 1, '2024-10-20 01:44:32', 1, '/img/jianhang.5f2be68a.svg', '储蓄卡', '20', '123', '#3973c4');
COMMIT;

-- ----------------------------
-- Table structure for t_budget
-- ----------------------------
DROP TABLE IF EXISTS `t_budget`;
CREATE TABLE `t_budget` (
  `id` int NOT NULL AUTO_INCREMENT,
  `type` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '1年预算2月预算',
  `budget_price` decimal(10,2) DEFAULT NULL COMMENT '预算金额',
  `user_id` int NOT NULL COMMENT '用户Id',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `delete` tinyint NOT NULL DEFAULT '0' COMMENT '0未删除1删除',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='预算设置表';

-- ----------------------------
-- Records of t_budget
-- ----------------------------
BEGIN;
INSERT INTO `t_budget` (`id`, `type`, `budget_price`, `user_id`, `create_time`, `delete`) VALUES (1, '1', 4561.00, 1, '2024-10-19 18:06:50', 0);
INSERT INTO `t_budget` (`id`, `type`, `budget_price`, `user_id`, `create_time`, `delete`) VALUES (2, '2', 456.00, 1, '2024-10-19 18:07:23', 0);
COMMIT;

-- ----------------------------
-- Table structure for t_classify
-- ----------------------------
DROP TABLE IF EXISTS `t_classify`;
CREATE TABLE `t_classify` (
  `id` int NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `user_id` int NOT NULL COMMENT '用户Id',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `delete` tinyint NOT NULL DEFAULT '0' COMMENT '0未删除1删除',
  `type` int DEFAULT NULL COMMENT '1支出 2收入',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='收支分类';

-- ----------------------------
-- Records of t_classify
-- ----------------------------
BEGIN;
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (1, '测试22', 0, '2024-10-18 15:17:58', 1, 1);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (2, '测试2221232', 1, '2024-10-19 11:44:39', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (3, '2', 1, '2024-10-19 11:41:39', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (4, '3333', 1, '2024-10-19 11:42:44', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (5, '213123', 1, '2024-10-19 11:43:07', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (6, '2', 1, '2024-10-19 11:43:41', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (7, '12312321', 1, '2024-10-19 11:43:48', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (8, '测试', 1, '2024-10-19 11:43:59', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (9, '22', 1, '2024-10-19 11:44:32', 0, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (11, '', 1, '2024-10-19 17:55:57', 1, 2);
INSERT INTO `t_classify` (`id`, `name`, `user_id`, `create_time`, `delete`, `type`) VALUES (12, 'ccccccccccccccc', 1, '2024-10-19 17:56:23', 1, 2);
COMMIT;

-- ----------------------------
-- Table structure for t_common_file
-- ----------------------------
DROP TABLE IF EXISTS `t_common_file`;
CREATE TABLE `t_common_file` (
  `id` bigint NOT NULL,
  `file_url` varchar(255) NOT NULL,
  `file_name` varchar(255) NOT NULL,
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COMMENT='文件信息';


-- ----------------------------
-- Table structure for t_to_do_matter
-- ----------------------------
DROP TABLE IF EXISTS `t_to_do_matter`;
CREATE TABLE `t_to_do_matter` (
  `id` int NOT NULL AUTO_INCREMENT,
  `title` varchar(255) NOT NULL COMMENT '提醒标题',
  `content` varchar(255) NOT NULL COMMENT '提醒内容',
  `user_id` int NOT NULL COMMENT '用户Id',
  `to_time` datetime NOT NULL COMMENT '提醒时间',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `delete` tinyint NOT NULL DEFAULT '0' COMMENT '0未删除1删除',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='待办事项表';

-- ----------------------------
-- Records of t_to_do_matter
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for t_user
-- ----------------------------
DROP TABLE IF EXISTS `t_user`;
CREATE TABLE `t_user` (
  `id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '用户名',
  `password` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '密码',
  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '真实姓名',
  `phone` varchar(11) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '手机号',
  `age` tinyint DEFAULT NULL COMMENT '年龄',
  `sex` tinyint DEFAULT NULL COMMENT '1男 2女',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  `delete` tinyint NOT NULL DEFAULT '0' COMMENT '0未删除1删除',
  `photo` bigint DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='用户表';

-- ----------------------------
-- Records of t_user
-- ----------------------------
BEGIN;
INSERT INTO `t_user` (`id`, `username`, `password`, `name`, `phone`, `age`, `sex`, `create_time`, `update_time`, `delete`, `photo`) VALUES (1, 'zhangsan', '123', '张三', '15533041111', 21, 2, '2024-10-18 14:42:23', '2024-10-19 16:59:34', 0, 150299994238208);
INSERT INTO `t_user` (`id`, `username`, `password`, `name`, `phone`, `age`, `sex`, `create_time`, `update_time`, `delete`, `photo`) VALUES (2, 'ceshi', 'ceshi', '测试', '15533041111', 2, 2, '2024-10-18 14:54:51', '2024-10-18 14:56:16', 1, NULL);
COMMIT;

-- ----------------------------
-- Table structure for users
-- ----------------------------
DROP TABLE IF EXISTS `users`;
CREATE TABLE `users` (
  `u_id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(255) DEFAULT NULL,
  `password` varchar(255) DEFAULT NULL,
  `name` varchar(255) DEFAULT NULL,
  `avatar` varchar(255) DEFAULT NULL,
  `gender` varchar(10) DEFAULT NULL,
  `role` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`u_id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb3 COMMENT='管理员表';

-- ----------------------------
-- Records of users
-- ----------------------------
BEGIN;
INSERT INTO `users` (`u_id`, `username`, `password`, `name`, `avatar`, `gender`, `role`) VALUES (1, 'yxy', '123456', '杨芯', 'https://yxy-study.oss-cn-nanjing.aliyuncs.com/15d82062-43d9-4450-bfb5-fb81613d1348.jpg', '男', 'ADMIN');
INSERT INTO `users` (`u_id`, `username`, `password`, `name`, `avatar`, `gender`, `role`) VALUES (2, '123', '123', '123', 'https://yxy-study.oss-cn-nanjing.aliyuncs.com/fade2efb-ff55-4974-bd92-4cdf7a7fb4bd.jpg', '男', 'ADMIN');
INSERT INTO `users` (`u_id`, `username`, `password`, `name`, `avatar`, `gender`, `role`) VALUES (3, '1234', '123', '1234', 'https://yxy-live-share.oss-cn-beijing.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240419210622.jpg', '男', 'ADMIN');
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;

```
### 依赖
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.iweb</groupId>
    <artifactId>manage-api</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>manage-api</name>
    <description>manage-api</description>
    <properties>
        <java.version>1.8</java.version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <spring-boot.version>2.6.13</spring-boot.version>
    </properties>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <!--Hutool Java工具包-->
        <dependency>
            <groupId>cn.hutool</groupId>
            <artifactId>hutool-all</artifactId>
            <version>5.8.18</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        <!--mybatis-plus核心库-->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>3.4.3.1</version>
        </dependency>
        <!--代码生成器依赖-->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-generator</artifactId>
            <version>3.4.1</version>
        </dependency>
        <!--JWT(Json Web Token)登录支持-->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt</artifactId>
            <version>0.9.1</version>
        </dependency>
        <!--freemarker-->
        <dependency>
            <groupId>org.freemarker</groupId>
            <artifactId>freemarker</artifactId>
            <version>2.3.30</version>
        </dependency>
        <!--德鲁伊-->
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>druid-spring-boot-starter</artifactId>
            <version>1.2.4</version>
        </dependency>


        <!-- https://mvnrepository.com/artifact/ch.ethz.ganymed/ganymed-ssh2 -->
        <dependency>
            <groupId>ch.ethz.ganymed</groupId>
            <artifactId>ganymed-ssh2</artifactId>
            <version>262</version>
        </dependency>

        <dependency>
            <groupId>cn.hutool</groupId>
            <artifactId>hutool-all</artifactId>
            <version>5.7.21</version>
        </dependency>


        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>fastjson</artifactId>
            <version>1.2.78</version>
        </dependency>

        <dependency>
            <groupId>com.aliyun.oss</groupId>
            <artifactId>aliyun-sdk-oss</artifactId>
            <version>3.15.1</version>
        </dependency>




        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>
        <dependency>
            <groupId>redis.clients</groupId>
            <artifactId>jedis</artifactId>
        </dependency>

        <dependency>
            <groupId>com.fasterxml.jackson.datatype</groupId>
            <artifactId>jackson-datatype-jsr310</artifactId>
            <version>2.13.3</version>
        </dependency>

        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>easyexcel</artifactId>
            <version>3.3.2</version> <!-- Or the latest version -->
        </dependency>

        <!--        es  -->

        <dependency>
            <groupId>co.elastic.clients</groupId>
            <artifactId>elasticsearch-java</artifactId>
            <version>8.1.0</version>
        </dependency>
        <dependency>
            <groupId>org.apache.httpcomponents.client5</groupId>
            <artifactId>httpclient5</artifactId>
            <version>5.1.3</version>
        </dependency>
        <!-- Jackson JSON Processor -->
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.13.4</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-core</artifactId>
            <version>2.13.4</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-annotations</artifactId>
            <version>2.13.4</version>
        </dependency>

        <dependency>
            <groupId>com.github.pagehelper</groupId>
            <artifactId>pagehelper-spring-boot-starter</artifactId>
            <version>1.4.3</version>
        </dependency>

        <!-- Jakarta JSON -->
        <dependency>
            <groupId>org.glassfish</groupId>
            <artifactId>jakarta.json</artifactId>
            <version>2.0.1</version>
        </dependency>


    </dependencies>
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-dependencies</artifactId>
                <version>${spring-boot.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.8.1</version>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>${spring-boot.version}</version>
                <configuration>
                    <mainClass>com.iweb.Application</mainClass>
                    <skip>false</skip>
                </configuration>
                <executions>
                    <execution>
                        <id>repackage</id>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project>


```
## 配置代码
### 配置类
![img_5.png](houtai/img_5.png)
### 枚举类
![img_3.png](qiantai/img_3.png)
### 工具类
![img_4.png](qiantai/img_4.png)
## 实体类 

### 如何创建

按照表和字段添加实体类，表名作为类名，字段作为属性名，注意的是驼峰命名

```sql
CREATE TABLE `t_common_file` (
  `id` bigint NOT NULL,
  `file_url` varchar(255) NOT NULL,
  `file_name` varchar(255) NOT NULL,
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COMMENT='文件信息';
```

对应的表

```java
@Data
public class TCommonFile{

    private Long id;

    private String fileUrl;

    private String fileName;

    private LocalDateTime createTime;


}
```

### 注意事项

注意表字段中有关键字`delete`，所以我们对实体类做出如下更改，代表的涵义是去除关键字的属性，

```java
	/**
     * 0未删除1删除
     */
    @TableField("`delete`")
    private Integer delete;
```

## 登录拦截器

这个类是全局接口的拦截器，请求任何接口都会到这里，接下来我们从请求头中获取了token，这个就是我们登录接口返回的token，前端拿到以后会吧token放到请求头中，每次请求都带过来，带过来以后我们判断，如果没有带，直接提示token不存在，如果带了，我们判断这个token是否在redis中，如果不在提示用户未登录，因为，我们登录接口调用成功以后，会直接进行吧token存储到jwt中，这里拿着token去jwt中进行解析用户信息，看是否存在用户

```java
@Slf4j
@Component
public class LoginInterceptor implements HandlerInterceptor {

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception{

        // 1. 获取请求的URL
        // 2. 判断请求中是否有login

        // 3. 获取请求头中的令牌（token - jwt）
        String token = request.getHeader("token");
        // 4. 判断令牌是否存在，不存在返回登录失败
        if (!StringUtils.hasLength(token)){
            log.info("token不存在");
            Result responseResult = Result.failed("NOT_LOGIN");
            String json = JSONObject.toJSONString(responseResult);
            response.setContentType("application/json;charset=utf-8");
            response.getWriter().write(json);
            return false;
        }
        // 5. 解析token，解析失败返回登录失败
        try{
            JwtUtils.parseJwt(token);
        }catch (Exception e){
            log.info("令牌解析失败");
            Result responseResult = Result.failed("NOT_LOGIN");
            String json = JSONObject.toJSONString(responseResult);
            response.setContentType("application/json;charset=utf-8");
            response.getWriter().write(json);
            return false;
        }
        // 6. 放行
        return true;
    }

}
```

## 账号密码登录接口

### 说明
```text
描述：账号密码登录接口
接口：/login
请求方式：post
```
### 书写Controller
```java
@Slf4j
@RestController
public class LoginController {

    @Resource
    private UsersService usersService;

@PostMapping("/login")
public Result login(@RequestBody Users users) {
    // 记录登录日志
    log.info("员工登录" + users.getName());

    // 调用服务层方法进行登录验证
    Users u = usersService.login(users);

    // 检查登录是否成功
    if (u != null) {
        // 检查用户角色是否为管理员
        if (!u.getRole().equals(RoleEnum.ADMIN.getRoleCode())) {
            return Result.failed("用户角色必须是管理员");
        }

        // 创建一个包含用户信息的Map
        Map<String, Object> claims = new HashMap<>();
        claims.put("id", u.getUId());
        claims.put("name", u.getName());
        claims.put("username", u.getUsername());

        // 通过生成的用户信息claims生成JWT令牌
        String jwt = JwtUtils.generateJwt(claims);

        // 返回成功结果并附带JWT令牌
        return Result.success(jwt);
    }

    // 登录失败，返回错误信息
    return Result.failed("用户名或者密码错误");
}


}
```
接口使用post请求方式进行调用，然后调用service层进行获取token最后返回给前端token
### 书写Service 
```java
public interface UsersService extends IService<Users> {
    Users login(Users users);
}
```
### 书写ServiceImpl
```java
@Service
public class UsersServiceImpl extends ServiceImpl<UsersMapper, Users> implements UsersService {
    @Override
    public Users login(Users users) {
        return usersMapper.getByUserNameAndPassword(users);
    }
}
```
登录这块的话，手机号登录和验证码登录，都放在了一个接口中，根据前端传的loginType来判断，然后最后验证通过，生成token，调用redis吧token
信息存到redis中
### 书写mapper层
```java
public interface UsersMapper extends BaseMapper<Users> {
    @Select("SELECT * FROM users WHERE username = #{username} AND password = #{password}")
    Users getByUserNameAndPassword(Users users);
}
```
### 前后端联调
浏览器输入：http://localhost:8081/#/Login
![img_6.png](houtai/img_6.png)

## 获取菜单数据接口
### 说明
```text
描述：获取菜单数据接口
接口：/menu/list
请求方式：get
```
### 书写Controller
```java
@RestController
@RequestMapping("/menu")
public class MenuController {

    @Resource
    private MenuService menuService;


@RequestMapping("/list")
public Result getList() {
    // 调用服务层方法获取所有菜单列表
    List<Menu> list = menuService.list();
    
    // 获取全部一级菜单
    List<Menu> parentMenu = list.stream()
        .filter(item -> item.getParent().intValue() == 0)
        .collect(Collectors.toList());
    
    // 组装一级菜单中的所有二级菜单
    for (Menu menu : parentMenu) {
        // 获取当前一级菜单的所有子菜单
        List<Menu> children = list.stream()
            .filter(item -> item.getParent().equals(menu.getId()))
            .collect(Collectors.toList());
        
        // 如果子菜单列表不为空，则设置到父菜单中
        if (!children.isEmpty()) {
            menu.setChildren(children);
        }
    }

    // 返回成功的结果
    return Result.success(parentMenu);
}

}
```
### 书写Service
```java
public interface MenuService extends IService<Menu> {

}
```
### 书写ServiceImpl
```java
@Service
public class MenuServiceImpl extends ServiceImpl<MenuMapper, Menu>
    implements MenuService{

}

```
### 书写Mapper
```java
public interface MenuMapper extends BaseMapper<Menu> {

}
```
### 前后端联调
浏览器输入：http://localhost:8081/#/FristPage
![img_8.png](houtai/img_8.png)
## 获取个人信息接口
### 说明
```text
描述：获取个人信息接口
接口：/users/userInfo
请求方式：get
```
### 书写Controller
```java
@RestController
@RequestMapping("/users")
public class UsersController {

    @Resource
    private UsersService usersService;

    @GetMapping("/userInfo")
    public Result getUserInfo(@RequestHeader String token) {
        // 解析JWT令牌
        Claims claims = JwtUtils.parseJwt(token);

        // 获取登录用户的ID
        String loginId = claims.get("id").toString();

        // 根据ID获取用户信息
        Users loginUser = usersService.getById(Integer.parseInt(loginId));

        // 返回成功结果并附带用户信息
        return Result.success(loginUser);
    }

}
```
### 前后端联调
浏览器输入：http://localhost:8081/#/upInfo
![img_9.png](houtai/img_9.png)
## 管理员列表接口
### 说明
```text
描述：管理员列表接口
接口：/users/list
请求方式：get
```
### 书写Dto
```java
@Data
public class ListUserPageReq {


    private String name;

    private String username;


    private String remark;

    /**
     * 1支出 2收入
     */
    private Integer type;


}
```
### 书写Controller
```java
@GetMapping("/list")
    public Result listUserPage(ListUserPageReq listUserPageReq,
                               @RequestParam(value = "pageNum", defaultValue = "1") Integer pageNum,
                               @RequestParam(value = "pageSize", defaultValue = "20") Integer pageSize) {

        return Result.success(usersService.listUserPage(pageNum,pageSize,listUserPageReq));
    }
```
### 书写Service
```java
    Page<Users> listUserPage(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq);

```
### 书写serviceImpl
```java
@Override
public Page<Users> listUserPage(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq) {
    // 创建一个Lambda查询对象
    LambdaQueryWrapper<Users> lambdaQuery = Wrappers.<Users>lambdaQuery();

    // 如果传入的参数名称不为空，则添加一个模糊查询条件
    if (StringUtil.isNotEmpty(listUserPageReq.getName())) {
        lambdaQuery.like(Users::getName, listUserPageReq.getName());
        // 对应的SQL片段是： WHERE name LIKE '%<name>%'
    }

    // 创建一个分页对象
    Page<Users> page = new Page<>(pageNum, pageSize);

    // 执行分页查询并返回结果
    Page<Users> resultPage = baseMapper.selectPage(page, lambdaQuery);
    // 对应的SQL语句会根据上述条件生成一个带有LIMIT和OFFSET的SQL查询，例如：
    // SELECT * FROM users WHERE name LIKE '%<name>%' LIMIT <pageSize>

    // 返回分页结果
    return resultPage;
}

```
### 前后端联调
浏览器输入：http://localhost:8081/#/CustomerList
![img_10.png](houtai/img_10.png)
## 增加管理员接口
### 说明
```text
描述：增加管理员接口
接口：/users/saveUser
请求方式：post
```
### 书写Controller
```java
  @PostMapping("/saveUser")
    public Result saveUser(@RequestBody Users users){
        usersService.saveUser(users);
        return Result.success();
    }
```
### 书写Service
```java
    void saveUser(Users users);
```
### 书写ServiceImpl
```java
 @Override
    public void saveUser(Users users) {
        users.setRole("ADMIN");
        baseMapper.insert(users);
    }
```
### 前后端联调
浏览器输入：http://localhost:8081/#/CustomerList
![img_12.png](houtai/img_12.png)
## 修改管理员接口
### 说明
```text
描述：获取验证码接口
接口：/users/updateUser
请求方式：post
```
### 书写Controller
```java

@PostMapping("/updateUser")
public Result updateUser(@RequestBody Users users){
        usersService.updateUser(users);
        return Result.success();
        }
```
### 书写Serivce
```java
    void updateUser(Users users);
```
### 书写serviceImpl
```java
   @Override
    public void updateUser(Users users) {
        baseMapper.updateById(users);
    }
```
### 前后端联调
浏览器输入：http://localhost:8081/#/CustomerList
![img_13.png](houtai/img_13.png)
## 删除管理员接口
### 说明
```text
描述：删除管理员接口
接口：/users/deleteUser/{id}
请求方式：get
```
### 书写Controller
```java
 @GetMapping("/deleteUser/{id}")
    public Result deleteUser(@PathVariable("id") Integer id){
        usersService.deleteUser(id);
        return Result.success();
    }
```
### 书写Service
```java
    void deleteUser(Integer id);
```
### 书写serviceImpl
```java
@Override
    public void deleteUser(Integer id) {
        baseMapper.deleteById(id);
    }
```
### 前后端联调
浏览器输入：http://localhost:8081/#/CustomerList
![img_14.png](houtai/img_14.png)
## 用户管理列表
### 说明
```text
描述：用户管理列表
接口：/user/list
请求方式：get
```
### 书写Controller
```java
@RestController
@RequestMapping("/user")
public class UserController {

    @Autowired
    private UserService userService;
    @GetMapping("/list")
    public Result userList(ListUserPageReq listUserPageReq,
                           @RequestParam(value = "pageNum", defaultValue = "1") Integer pageNum,
                           @RequestParam(value = "pageSize", defaultValue = "20") Integer pageSize) {

        return Result.success(userService.userList(pageNum,pageSize,listUserPageReq));
    }
}
```
### 书写Service
```java
public interface UserService extends IService<TUser> {
    Page<TUser> userList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq);

}
```
### 书写Serviceimpl
```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, TUser>
    implements UserService {


    @Override
    public Page<TUser> userList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq) {
        // 创建一个Lambda查询对象
        LambdaQueryWrapper<TUser> lambdaQuery = new LambdaQueryWrapper<>();

        // 如果传入的参数不为空且用户名不为空，则添加一个模糊查询条件
        if (listUserPageReq != null && StringUtil.isNotEmpty(listUserPageReq.getUsername())) {
            lambdaQuery.like(TUser::getUsername, listUserPageReq.getUsername());
            // 对应的SQL片段是：
            // WHERE username LIKE '%<username>%'
        }

        // 如果传入的参数不为空且名字不为空，则添加一个模糊查询条件
        if (listUserPageReq != null && StringUtil.isNotEmpty(listUserPageReq.getName())) {
            lambdaQuery.like(TUser::getName, listUserPageReq.getName());
            // 对应的SQL片段是：
            // WHERE name LIKE '%<name>%'
        }

        // 添加一个精确查询条件，确保用户未被删除（假设`delete`字段表示是否删除，0表示未删除）
        lambdaQuery.eq(TUser::getDelete, 0);
        // 对应的SQL片段是：
        // WHERE delete = 0

        // 创建一个分页对象
        Page<TUser> page = new Page<>(pageNum, pageSize);

        // 执行分页查询并返回结果
        Page<TUser> resultPage = baseMapper.selectPage(page, lambdaQuery);
        // 对应的SQL语句会根据上述条件生成一个带有LIMIT和OFFSET的SQL查询，例如：
        // SELECT * FROM user WHERE username LIKE '%<username>%' AND name LIKE '%<name>%' AND delete = 0 LIMIT <pageSize>

        // 返回分页结果
        return resultPage;
    }

}
```
### 书写Mapper
```java
public interface UserMapper extends BaseMapper<TUser> {

}
```
### 前后端联调
浏览器输入：http://localhost:8081/#/CommonCustomer
![img_15.png](houtai/img_15.png)
## 增加用户接口
### 说明
```text
描述：增加用户接口
接口：/user/insert
请求方式：post
```
### 书写Controller
```java
    @PostMapping("/insert")
    public Result insertUser(@RequestBody TUser user) {
        return Result.success(userService.insertUser(user));
    }
```
### 书写service
```java
    Boolean insertUser(TUser user);
```
### 书写serviceImpl
```java
@Override
    public Boolean insertUser(TUser user) {
        if(StringUtil.isEmpty(user.getUsername())){
            throw new RuntimeException("用户名不能为空");
        }
        if(StringUtil.isEmpty(user.getPassword())){
            throw new RuntimeException("密码不能为空");
        }
        if(StringUtil.isEmpty(user.getPhone())){
            throw new RuntimeException("手机号不能为空");
        }
        user.setDelete(0);
        return this.save(user);
    }

```
### 前后端联调
浏览器输入：http://localhost:8081/#/CommonCustomer
![img_16.png](houtai/img_16.png)
## 删除用户接口
### 说明
```text
描述：删除用户接口
接口：/user/delete
请求方式：get
```
### 书写Controller
```java
@GetMapping("/delete")
    public Result deleteUser(@RequestParam Integer id) {
        return Result.success(userService.deleteUser(id));
    }
```
### 书写service
```java
    Boolean deleteUser(Integer userId);
```
### 书写serviceImpl
```java
@Override
public Boolean deleteUser(Integer userId) {
    // 检查用户ID是否为空
    if (userId == null) {
        throw new RuntimeException("用户Id不能为空");
    }

    // 根据用户ID获取用户信息
    TUser user = getById(userId);
    
    // 检查用户是否存在
    if (user == null) {
        throw new RuntimeException("用户不存在");
    }

    // 更新用户状态为已删除
    return this.lambdaUpdate()
        	// 设置 TUser::getDelete 字段为 1，表示用户已被删除。
            .set(TUser::getDelete, 1)
        	// 表示只更新指定ID的用户。
            .eq(TUser::getId, userId)
        	// UPDATE users SET delete = 1 WHERE id = userId
            .update();
}

```
### 前后端联调
浏览器输入：http://localhost:8081/#/CommonCustomer
![img_17.png](houtai/img_17.png)
## 修改用户接口
### 说明
```text
描述：修改用户接口
接口：/user/update
请求方式：post
```
### 书写Controller
```java

    @PostMapping("/update")
    public Result updateUser(@RequestBody TUser user) {
        return Result.success(userService.updateUser(user));
    }
```
### 书写service
```java
    Boolean updateUser(TUser user);

```
### 书写serviceImpl
```java
  @Override
    public Boolean updateUser(TUser upUser) {
        if(upUser == null){
            throw new RuntimeException("用户信息不存在");
        }
        if(upUser.getId() == null){
            throw new RuntimeException("用户Id不能为空");
        }
        TUser user = getById(upUser.getId());
        if(user == null){
            throw new RuntimeException("用户不存在");
        }
        if(StringUtil.isEmpty(upUser.getUsername())){
            throw new RuntimeException("用户名不能为空");
        }
        if(StringUtil.isEmpty(upUser.getPassword())){
            throw new RuntimeException("密码不能为空");
        }
        if(StringUtil.isEmpty(upUser.getPhone())){
            throw new RuntimeException("手机号不能为空");
        }
        return this.updateById(upUser);
    }
```
### 前后端联调
浏览器输入：http://localhost:8081/#/CommonCustomer
![img_18.png](houtai/img_18.png)
## 获取分类列表
### 说明
```text
描述：获取分类列表
接口：/classify/list
请求方式：get
```
### 书写Controller
```java
@RestController
@RequestMapping("classify")
public class ClassifyController {


    @Autowired
    private ClassifyService classifyService;

    /**
     * 分页查询所有数据
     *
     * @param listUserPageReq 请求体
     * @param pageNum         当前页
     * @param pageSize        每页大小
     */
    @GetMapping("/list")
    public Result classifyList(ListUserPageReq listUserPageReq,
                               @RequestParam(value = "pageNum", defaultValue = "1") Integer pageNum,
                               @RequestParam(value = "pageSize", defaultValue = "20") Integer pageSize) {

        return Result.success(classifyService.classifyList(pageNum, pageSize, listUserPageReq));
    }

}
```
### 书写service
```java
public interface ClassifyService extends IService<Classify> {

    Page<Classify> classifyList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq);

}
```
### 书写serviceImpl
```java
@Service
public class ClassifyServiceImpl extends ServiceImpl<ClassifyMapper, Classify>
    implements ClassifyService {

    @Override
    public Page<Classify> classifyList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq) {
        // 创建一个Lambda查询对象
        LambdaQueryWrapper<Classify> lambdaQueryWrapper = new LambdaQueryWrapper<>();

        // 如果传入的参数名称不为空，则添加一个模糊查询条件
        if (StringUtil.isNotEmpty(listUserPageReq.getName())) {
            lambdaQueryWrapper.like(Classify::getName, listUserPageReq.getName());
            // 对应的SQL片段是：
            // WHERE name LIKE '%<name>%'
        }

        // 添加一个精确查询条件，确保记录未被删除（假设`delete`字段表示是否删除，0表示未删除）
        lambdaQueryWrapper.eq(Classify::getDelete, 0);
        // 对应的SQL片段是：
        // WHERE delete = 0

        // 创建一个分页对象
        Page<Classify> page = new Page<>(pageNum, pageSize);

        // 执行分页查询并返回结果
        Page<Classify> resultPage = baseMapper.selectPage(page, lambdaQueryWrapper);
        // 对应的SQL语句会根据上述条件生成一个带有LIMIT和OFFSET的SQL查询，例如：
        // SELECT * FROM classify WHERE name LIKE '%<name>%' AND delete = 0 LIMIT <pageSize>

        // 返回分页结果
        return resultPage;
    }

}
```
### 书写mapper
```java
public interface ClassifyMapper extends BaseMapper<Classify> {

}

```
### 前后端联调
浏览器输入：http://localhost:8081/#/classifyList
![img_19.png](houtai/img_19.png)
## 增加分类接口  
### 说明
```text
描述：增加分类接口
接口：/classify/insert
请求方式：post
```
### 书写Controller
```java
@PostMapping("/insert")
    public Result insertClassify(@RequestBody Classify classify) {
        return Result.success(classifyService.insertClassify(classify));
    }
```
### 书写service
```java
    Boolean insertClassify(Classify classify);

```
### 书写serviceImpl
```java
@Override
    public Boolean insertClassify(Classify classify) {
        if(classify == null){
            throw new RuntimeException("分类信息不能为空");
        }
        if(StringUtil.isEmpty(classify.getName())){
            throw new RuntimeException("分类名称不能为空");
        }
        if(null == classify.getType()){
            throw new RuntimeException("分类类型不能为空");
        }
        classify.setUserId(0);
        classify.setCreateTime(new Date());
        classify.setDelete(0);
        return save(classify);
    }
```
### 前后端联调
浏览器输入：http://localhost:8081/#/classifyList
![img_20.png](houtai/img_20.png)
## 修改分类接口
### 说明
```text
描述：修改分类接口
接口：/classify/update
请求方式：post
```
### 书写Controller
```java

    @PostMapping("/update")
    public Result updateClassify(@RequestBody Classify classify) {
        return Result.success(classifyService.updateClassify(classify));
    }
```
### 书写service
```java
Boolean updateClassify(Classify classify);
```
### 书写serviceImpl
```java
 @Override
    public Boolean updateClassify(Classify classify) {
        if(classify == null){
            throw new RuntimeException("分类Id不能为空");
        }
        if(classify.getId() == null){
            throw new RuntimeException("分类Id不能为空");
        }
        Classify sClassify = this.getById(classify.getId());
        if(sClassify==null){
            throw new RuntimeException("分类不存在");
        }
        if(StringUtil.isEmpty(classify.getName())){
            throw new RuntimeException("分类名称不能为空");
        }
        if(null == classify.getType()){
            throw new RuntimeException("分类类型不能为空");
        }
        return updateById(classify);
    }
```
### 前后端联调
浏览器输入：http://localhost:8090/#/classifyList
![img_21.png](img_21.png
## 删除分类接口
### 说明
```text
描述：删除分类接口
接口：/classify/delete
请求方式：get
```
### 书写Controller
```java

@GetMapping("/delete")
public Result deleteClassify(@RequestParam Integer id) {
        return Result.success(classifyService.deleteClassify(id));
}
```
### 书写service
```java
Boolean deleteClassify(Integer classifyId);
```
### 书写serviceImpl
```java
   @Override
public Boolean deleteUser(Integer userId) {
        if(userId == null){
        throw new RuntimeException("用户Id不能为空");
        }
        TUser user = getById(userId);
        if(user == null){
        throw new RuntimeException("用户不存在");
        }
        return this.lambdaUpdate().set(TUser::getDelete,1)
        .eq(TUser::getId,userId).update();
        }

```
### 前后端联调
浏览器输入：http://localhost:8090/#/classifyList
![img_22.png](houtai/img_22.png)
## 获取数据列表
### 说明
```text
描述：获取数据列表
接口：/accountion/record/list
请求方式：get
```
### 书写实体类

在实体类`AccountionRecord`中添加属性

```java
    @TableField(exist = false)
    @ExcelProperty(value = "用户名称",order = 0)
    private String userName;

    @TableField(exist = false)
    @ExcelProperty(value = "分类名称",order = 1)
    private String classifyName;

    @TableField(exist = false)
    private static final long serialVersionUID = 1L;


    private String year;

    private String month;

    private String day;
```

### 书写Controller

```java

@RestController
@RequestMapping("accountion/record")
public class AccountionRecordController {

    @Autowired
    private AccountionRecordService accountionRecordService;


    /**
     * 数据列表
     * @param listUserPageReq
     * @param pageNum
     * @param pageSize
     * @return
     */
    @GetMapping("/list")
    public Result accountionRecordList(ListUserPageReq listUserPageReq,
                               @RequestParam(value = "pageNum", defaultValue = "1") Integer pageNum,
                               @RequestParam(value = "pageSize", defaultValue = "20") Integer pageSize) {
        return Result.success(accountionRecordService.accountionRecordList(pageNum,pageSize,listUserPageReq));
    }
}
```
### 书写service
```java
public interface AccountionRecordService extends IService<AccountionRecord> {

    Page<AccountionRecord> accountionRecordList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq);
}
```
### 书写serviceImpl
```java

@Service
public class AccountionRecordServiceImpl extends ServiceImpl<AccountionRecordMapper, AccountionRecord>
        implements AccountionRecordService {


    @Autowired
    private UserService userService;
    @Autowired
    private ClassifyService classifyService;

    @Override
    public Page<AccountionRecord> accountionRecordList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq) {
        // 创建一个Lambda查询对象
        LambdaQueryWrapper<AccountionRecord> lambdaQueryWrapper = new LambdaQueryWrapper<>();

        // 如果传入的参数类型不为空且类型不为0，则添加一个精确查询条件
        if (null != listUserPageReq.getType() && listUserPageReq.getType() != 0) {
            lambdaQueryWrapper.eq(AccountionRecord::getType, listUserPageReq.getType());
            // 对应的SQL片段是：
            // WHERE type = <type>
        }

        // 如果传入的参数备注不为空，则添加一个模糊查询条件
        if (StringUtil.isNotEmpty(listUserPageReq.getRemark())) {
            lambdaQueryWrapper.like(AccountionRecord::getRemark, listUserPageReq.getRemark());
            // 对应的SQL片段是：
            // WHERE remark LIKE '%<remark>%'
        }

        // 添加一个精确查询条件，确保记录未被删除（假设`delete`字段表示是否删除，0表示未删除）
        lambdaQueryWrapper.eq(AccountionRecord::getDelete, 0);
        // 对应的SQL片段是：
        // WHERE delete = 0

        // 创建一个分页对象
        Page<AccountionRecord> page = new Page<>(pageNum, pageSize);

        // 执行分页查询并返回结果
        Page<AccountionRecord> resultPage = baseMapper.selectPage(page, lambdaQueryWrapper);
        // 对应的SQL语句会根据上述条件生成一个带有LIMIT和OFFSET的SQL查询，例如：
        // SELECT * FROM accountion_record WHERE type = <type> AND remark LIKE '%<remark>%' AND delete = 0 LIMIT <pageSize>

        // 获取查询结果中的记录列表
        List<AccountionRecord> records = resultPage.getRecords();

        // 遍历记录列表，填充额外信息
        for (AccountionRecord record : records) {
            // 根据用户ID获取用户信息
            TUser user = userService.getById(record.getUserId());
            // 设置用户名
            record.setUserName(user.getName());

            // 根据分类ID获取分类信息
            Classify classify = classifyService.getById(record.getClassifyId());
            // 设置分类名
            record.setClassifyName(classify.getName());
        }

        // 更新分页结果中的记录列表
        resultPage.setRecords(records);

        // 返回分页结果
        return resultPage;
    }

}
```
书写mapper
```java
public interface AccountionRecordMapper extends BaseMapper<AccountionRecord> {

}
```
### 前后端联调
浏览器输入：http://localhost:8081/#/dataList

## 导出接口
### 说明
```text
描述：导出接口
接口：/accountion/record/export
请求方式：get
```
### 创建Vo

```java
/**
 * 收支明细
 * @TableName t_accountion_record
 */
@TableName(value ="t_accountion_record")
@Data
public class AccountionRecordVo implements Serializable {


    /**
     * 1支出 2收入
     */
    @ExcelProperty(value = "类型",order = 2)
    private String type;

    /**
     * 金额
     */
    @ExcelProperty(value = "金额",order = 3)
    private BigDecimal price;

    /**
     * 备注
     */

    @ExcelProperty(value = "备注",order = 4)
    private String remark;

    /**
     * 创建时间
     */

    @ExcelProperty(value = "创建时间",order = 5)
    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    private Date createTime;


    @TableField(exist = false)
    @ExcelProperty(value = "用户名称",order = 0)
    private String userName;

    @TableField(exist = false)
    @ExcelProperty(value = "分类名称",order = 1)
    private String classifyName;
}
```

### 书写Controller

```java
/**
 * 数据导出
 */
@GetMapping("export")
public void export(
        @RequestParam(required = false) Integer type, // 获取请求参数type，可选
        @RequestParam(required = false) String remark, // 获取请求参数remark，可选
        HttpServletResponse response) throws Exception { // 响应对象

    // 设置文件名为“记账数据导出”，并进行URL编码处理
    String fileName = URLEncoder.encode("记账数据导出", StandardCharsets.UTF_8.name()).replaceAll("\\+", "%20");

    // 设置响应头，指定下载文件的名称
    response.setHeader("Content-disposition", "attachment;filename*=utf-8''" + fileName + ".xlsx");

    // 设置响应内容类型为Excel文件
    response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");

    // 创建ListUserPageReq对象，并设置type和remark参数
    ListUserPageReq listUserPageReq = new ListUserPageReq();
    listUserPageReq.setType(type);
    listUserPageReq.setRemark(remark);

    // 调用服务方法获取记账记录分页数据
    Page<AccountionRecord> accountionRecordPage = accountionRecordService.accountionRecordList(1, 999999, listUserPageReq);

    // 将AccountionRecord对象转换为AccountionRecordVo对象，并收集到列表中
    List<AccountionRecordVo> accountionRecordVoList = accountionRecordPage.getRecords().stream()
            .map(item -> {
                AccountionRecordVo accountionRecordVo = new AccountionRecordVo();
                accountionRecordVo.setType(item.getType() == 1 ? "支出" : "收入"); // 根据类型设置支出或收入
                accountionRecordVo.setRemark(item.getRemark()); // 设置备注
                accountionRecordVo.setPrice(item.getPrice()); // 设置价格
                accountionRecordVo.setUserName(item.getUserName()); // 设置用户名
                accountionRecordVo.setClassifyName(item.getClassifyName()); // 设置分类名
                accountionRecordVo.setCreateTime(item.getCreateTime()); // 设置创建时间
                return accountionRecordVo;
            }).collect(Collectors.toList());

    // 获取原始记录列表
    List<AccountionRecord> records = accountionRecordPage.getRecords();

    // 使用EasyExcel库将数据写入Excel文件
    EasyExcel.write(response.getOutputStream(), AccountionRecordVo.class)
            .sheet("sheet") // 指定工作表名称
            .doWrite(accountionRecordVoList); // 写入数据
}

```
### 前后端联调
浏览器输入：http://localhost:8081/#/dataList
![img_24.png](houtai/img_24.png)

## 数据恢复列表
### 说明
```text
描述：数据恢复列表
接口：/accountion/record/del/list
请求方式：get
```
### 书写Controller
```java
 @GetMapping("/del/list")
    public Result delList(ListUserPageReq listUserPageReq,
                                       @RequestParam(value = "pageNum", defaultValue = "1") Integer pageNum,
                                       @RequestParam(value = "pageSize", defaultValue = "20") Integer pageSize) {
        return Result.success(accountionRecordService.delList(pageNum,pageSize,listUserPageReq));
    }
```
### 书写service
```java
    Page<AccountionRecord> delList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq);
```
### 书写serviceImpl
```java
@Override
public Page<AccountionRecord> delList(Integer pageNum, Integer pageSize, ListUserPageReq listUserPageReq) {
    // 创建一个Lambda查询对象
    LambdaQueryWrapper<AccountionRecord> lambdaQueryWrapper = new LambdaQueryWrapper<>();

    // 如果传入的参数类型不为空且类型不为0，则添加一个精确查询条件
    if (null != listUserPageReq.getType() && listUserPageReq.getType() != 0) {
        lambdaQueryWrapper.eq(AccountionRecord::getType, listUserPageReq.getType());
        // 对应的SQL片段是：
        // WHERE type = <type>
    }

    // 如果传入的参数备注不为空，则添加一个模糊查询条件
    if (StringUtil.isNotEmpty(listUserPageReq.getRemark())) {
        lambdaQueryWrapper.like(AccountionRecord::getRemark, listUserPageReq.getRemark());
        // 对应的SQL片段是：
        // WHERE remark LIKE '%<remark>%'
    }

    // 添加一个精确查询条件，确保记录已被删除（假设`delete`字段表示是否删除，1表示已删除）
    lambdaQueryWrapper.eq(AccountionRecord::getDelete, 1);
    // 对应的SQL片段是：
    // WHERE delete = 1

    // 创建一个分页对象
    Page<AccountionRecord> page = new Page<>(pageNum, pageSize);

    // 执行分页查询并返回结果
    Page<AccountionRecord> resultPage = baseMapper.selectPage(page, lambdaQueryWrapper);
    // 对应的SQL语句会根据上述条件生成一个带有LIMIT和OFFSET的SQL查询，例如：
    // SELECT * FROM accountion_record WHERE type = <type> AND remark LIKE '%<remark>%' AND delete = 1 LIMIT <pageSize>

    // 获取查询结果中的记录列表
    List<AccountionRecord> records = resultPage.getRecords();

    // 遍历记录列表，填充额外信息
    for (AccountionRecord record : records) {
        // 根据用户ID获取用户信息
        TUser user = userService.getById(record.getUserId());
        // 设置用户名
        record.setUserName(user.getName());

        // 根据分类ID获取分类信息
        Classify classify = classifyService.getById(record.getClassifyId());
        // 设置分类名
        record.setClassifyName(classify.getName());
    }

    // 更新分页结果中的记录列表
    resultPage.setRecords(records);

    // 返回分页结果
    return resultPage;
}

```
### 前后端联调
浏览器输入：http://localhost:8081/#/dataRestore

## 恢复数据接口
### 说明
```text
描述：恢复数据接口
接口：/accountion/record/restore
请求方式：get
```
### 书写Controller
```java
  @GetMapping("/restore")
    public Result restore(@RequestParam Integer id){
        return Result.success(accountionRecordService.restore(id));
    }
```
### 书写service
```java
    Boolean restore(Integer id);
```
### 书写serviceImpl
```java
   @Override
    public Boolean restore(Integer id) {
        if (id == null) {
            throw new RuntimeException("id不能为空");

        }
        AccountionRecord accountionRecord = this.getById(id);
        if (accountionRecord == null) {
            throw new RuntimeException("信息不存在");
        }
        AccountionRecord upAccountionRecord = new AccountionRecord();
        upAccountionRecord.setId(id);
        upAccountionRecord.setDelete(0);
        return updateById(upAccountionRecord);
    }
```
### 前后端联调
浏览器输入：http://localhost:8090/#/classifyList
![img_26.png](houtai/img_26.png)
